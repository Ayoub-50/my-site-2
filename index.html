<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تلاوات القرآن الكريم</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&family=Amiri:wght@400;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #064e3b 0%, #065f46 25%, #047857 50%, #10b981 75%, #34d399 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #fff;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* خلفية إسلامية مزخرفة */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(255,255,255,0.02) 35px, rgba(255,255,255,0.02) 70px),
                repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(255,255,255,0.02) 35px, rgba(255,255,255,0.02) 70px);
            pointer-events: none;
            z-index: 1;
        }

        body::after {
            content: '☪';
            position: fixed;
            top: -100px;
            right: -100px;
            font-size: 500px;
            opacity: 0.03;
            color: white;
            pointer-events: none;
            z-index: 1;
            animation: floatStar 20s ease-in-out infinite;
        }

        @keyframes floatStar {
            0%, 100% { transform: rotate(0deg) translateY(0); }
            50% { transform: rotate(15deg) translateY(20px); }
        }

        .container {
            position: relative;
            z-index: 2;
        }

        /* البسملة المزخرفة */
        .bismillah-container {
            text-align: center;
            padding: 30px 20px 20px;
            background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid rgba(255,255,255,0.2);
            position: relative;
            overflow: hidden;
        }

        .bismillah-container::before,
        .bismillah-container::after {
            content: '✦';
            position: absolute;
            top: 50%;
            font-size: 30px;
            color: rgba(255,255,255,0.3);
            animation: twinkle 3s ease-in-out infinite;
        }

        .bismillah-container::before {
            left: 10%;
        }

        .bismillah-container::after {
            right: 10%;
            animation-delay: 1.5s;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: translateY(-50%) scale(1); }
            50% { opacity: 0.8; transform: translateY(-50%) scale(1.2); }
        }

        .bismillah {
            font-family: 'Scheherazade New', 'Amiri', serif;
            font-size: 52px;
            font-weight: 700;
            color: #fef3c7;
            text-shadow: 
                0 0 10px rgba(254, 243, 199, 0.5),
                0 0 20px rgba(254, 243, 199, 0.3),
                2px 2px 4px rgba(0,0,0,0.3);
            letter-spacing: 2px;
            margin: 0;
            animation: bismillahGlow 3s ease-in-out infinite;
            line-height: 1.4;
        }

        @keyframes bismillahGlow {
            0%, 100% { 
                text-shadow: 
                    0 0 10px rgba(254, 243, 199, 0.5),
                    0 0 20px rgba(254, 243, 199, 0.3),
                    2px 2px 4px rgba(0,0,0,0.3);
            }
            50% { 
                text-shadow: 
                    0 0 15px rgba(254, 243, 199, 0.7),
                    0 0 30px rgba(254, 243, 199, 0.5),
                    2px 2px 6px rgba(0,0,0,0.4);
            }
        }

        .bismillah-ornament {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            color: rgba(255,255,255,0.6);
            font-size: 20px;
        }

        .ornament-line {
            width: 80px;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
        }

        /* الهيدر */
        .header {
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 26px;
            font-weight: 800;
            color: #fef3c7;
            text-shadow: 0 2px 10px rgba(254, 243, 199, 0.3);
        }

        .logo i {
            font-size: 32px;
            color: #d1fae5;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .header-icons {
            display: flex;
            gap: 12px;
        }

        .icon-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            border: 2px solid rgba(209, 250, 229, 0.3);
            color: #d1fae5;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }

        .icon-btn:hover {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(52, 211, 153, 0.4));
            border-color: #d1fae5;
            transform: translateY(-3px) rotate(5deg);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        /* البانر الترحيبي */
        .welcome-banner {
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.25) 0%, 
                rgba(52, 211, 153, 0.25) 50%,
                rgba(16, 185, 129, 0.25) 100%);
            border: 2px solid rgba(209, 250, 229, 0.3);
            border-radius: 25px;
            padding: 30px;
            margin: 25px 20px;
            text-align: center;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: shimmer 6s linear infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .welcome-banner h2 {
            font-size: 28px;
            margin-bottom: 12px;
            color: #fef3c7;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .welcome-banner p {
            color: #d1fae5;
            font-size: 17px;
            position: relative;
            z-index: 1;
            line-height: 1.6;
        }

        /* منطقة البحث */
        .hero {
            text-align: center;
            padding: 40px 20px;
        }

        .hero h1 {
            font-size: 38px;
            margin-bottom: 15px;
            color: #fef3c7;
            font-weight: 800;
            text-shadow: 0 2px 15px rgba(0, 0, 0, 0.3);
        }

        .hero p {
            color: #d1fae5;
            margin-bottom: 40px;
            font-size: 19px;
            font-weight: 500;
        }

        .search-box {
            max-width: 650px;
            margin: auto;
            background: rgba(255, 255, 255, 0.12);
            border-radius: 35px;
            padding: 10px;
            display: flex;
            gap: 12px;
            border: 2px solid rgba(209, 250, 229, 0.4);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .search-box:focus-within {
            border-color: #d1fae5;
            box-shadow: 0 10px 50px rgba(16, 185, 129, 0.3);
            transform: translateY(-2px);
        }

        .search-box input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            color: white;
            font-size: 17px;
            padding: 16px 22px;
            font-weight: 500;
        }

        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .search-btn {
            background: linear-gradient(135deg, #10b981, #34d399);
            border: none;
            border-radius: 28px;
            padding: 14px 35px;
            color: white;
            cursor: pointer;
            font-weight: 700;
            font-size: 17px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .search-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.6);
            background: linear-gradient(135deg, #059669, #10b981);
        }

        .search-btn:active {
            transform: translateY(-1px);
        }

        /* الاقتراحات */
        .suggestions {
            margin-top: 35px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .suggestions button {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(209, 250, 229, 0.3);
            color: #d1fae5;
            padding: 14px 24px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .suggestions button:hover {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(52, 211, 153, 0.3));
            border-color: #d1fae5;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.3);
        }

        /* قسم القراء المميزين */
        .reciters-section {
            margin: 40px auto;
            padding: 30px;
            max-width: 1400px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(52, 211, 153, 0.1));
            border-radius: 30px;
            border: 2px solid rgba(209, 250, 229, 0.2);
            backdrop-filter: blur(10px);
        }

        .section-header-reciters {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 35px;
            position: relative;
        }

        .section-header-reciters::before,
        .section-header-reciters::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(209, 250, 229, 0.3), transparent);
        }

        .section-title-reciters {
            font-size: 32px;
            font-weight: 800;
            color: #fef3c7;
            text-shadow: 0 2px 10px rgba(254, 243, 199, 0.3);
            margin: 0;
            white-space: nowrap;
        }

        .section-icon {
            font-size: 28px;
            color: #d1fae5;
            animation: iconPulse 2s ease-in-out infinite;
        }

        @keyframes iconPulse {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.15); opacity: 1; }
        }

        .reciters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .reciter-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(52, 211, 153, 0.15));
            border: 2px solid rgba(209, 250, 229, 0.25);
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .reciter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .reciter-card:hover::before {
            opacity: 1;
        }

        .reciter-card:hover {
            transform: translateY(-10px) scale(1.03);
            border-color: #d1fae5;
            box-shadow: 
                0 15px 35px rgba(16, 185, 129, 0.3),
                0 0 25px rgba(52, 211, 153, 0.2);
        }

        .reciter-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(52, 211, 153, 0.3));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 38px;
            color: #d1fae5;
            border: 3px solid rgba(209, 250, 229, 0.3);
            transition: all 0.4s ease;
            position: relative;
            z-index: 1;
        }

        .reciter-card:hover .reciter-icon {
            transform: rotate(360deg) scale(1.1);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.5), rgba(52, 211, 153, 0.5));
            border-color: #d1fae5;
            box-shadow: 0 0 20px rgba(52, 211, 153, 0.5);
        }

        .reciter-name {
            font-size: 20px;
            font-weight: 700;
            color: #fef3c7;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            line-height: 1.4;
        }

        .reciter-badge {
            display: inline-block;
            padding: 8px 18px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.25), rgba(52, 211, 153, 0.25));
            border: 1px solid rgba(209, 250, 229, 0.3);
            border-radius: 20px;
            color: #d1fae5;
            font-size: 14px;
            font-weight: 600;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .reciter-card:hover .reciter-badge {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(52, 211, 153, 0.4));
            border-color: #d1fae5;
            transform: scale(1.05);
        }

        /* استجابة للشاشات الصغيرة */
        @media (max-width: 768px) {
            .reciters-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 15px;
            }

            .reciter-card {
                padding: 20px 15px;
            }

            .reciter-icon {
                width: 65px;
                height: 65px;
                font-size: 30px;
                margin-bottom: 15px;
            }

            .reciter-name {
                font-size: 16px;
            }

            .reciter-badge {
                font-size: 12px;
                padding: 6px 14px;
            }

            .section-title-reciters {
                font-size: 24px;
            }
        }

        @media (max-width: 480px) {
            .reciters-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .section-header-reciters {
                flex-direction: column;
                gap: 10px;
            }

            .section-header-reciters::before,
            .section-header-reciters::after {
                display: none;
            }
        }

        /* منطقة النتائج */
        .results-container {
            padding: 20px;
            margin-top: 20px;
            max-width: 950px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 80px;
        }

        .results-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            font-size: 22px;
            font-weight: 700;
            color: #fef3c7;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            padding: 15px 20px;
            border-radius: 15px;
            border: 2px solid rgba(209, 250, 229, 0.3);
        }

        .track-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 22px;
            margin-bottom: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .track-item:hover {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.15));
            border-color: rgba(209, 250, 229, 0.5);
            transform: translateX(-5px);
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.3);
        }

        .track-info h4 {
            color: #fef3c7;
            margin-bottom: 8px;
            font-size: 19px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .track-info h4 i {
            color: #10b981;
            font-size: 20px;
        }

        .duration {
            color: #d1fae5;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 500;
        }

        .track-actions {
            display: flex;
            gap: 12px;
        }

        .circle-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #34d399);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .circle-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.6);
        }

        .download-btn {
            background: linear-gradient(135deg, #059669, #10b981);
        }

        /* مؤشر التحميل */
        .loading-indicator {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(209, 250, 229, 0.3);
            border-top-color: #10b981;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: #d1fae5;
            font-size: 18px;
            font-weight: 600;
        }

        /* Footer المطور */
        .developer-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, rgba(6, 78, 59, 0.95), rgba(6, 95, 70, 0.95));
            backdrop-filter: blur(15px);
            border-top: 2px solid rgba(209, 250, 229, 0.3);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            box-shadow: 0 -5px 30px rgba(0, 0, 0, 0.3);
        }

        .developer-info {
            display: flex;
            align-items: center;
            gap: 15px;
            color: #d1fae5;
            font-size: 16px;
        }

        .developer-info i {
            color: #10b981;
            font-size: 22px;
            animation: pulse 2s ease-in-out infinite;
        }

        .developer-name {
            font-weight: 700;
            color: #fef3c7;
        }

        .telegram-link {
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #10b981, #34d399);
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .telegram-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.6);
            background: linear-gradient(135deg, #059669, #10b981);
        }

        .telegram-link i {
            font-size: 20px;
        }

        /* صفحة المشغل */
        .player-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #064e3b 0%, #065f46 25%, #047857 50%, #10b981 75%, #34d399 100%);
            z-index: 1000;
            display: none;
            flex-direction: column;
            overflow-y: auto;
        }

        .player-page.active {
            display: flex;
        }

        .player-header {
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .close-player-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.2));
            border: 2px solid rgba(254, 202, 202, 0.4);
            color: #fecaca;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 22px;
        }

        .close-player-btn:hover {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.4), rgba(220, 38, 38, 0.4));
            border-color: #fca5a5;
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 5px 20px rgba(239, 68, 68, 0.4);
        }

        .player-loading {
            flex: 1;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 6px solid rgba(209, 250, 229, 0.3);
            border-top-color: #10b981;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .player-content {
            flex: 1;
            display: none;
            flex-direction: column;
            justify-content: center;
            padding: 30px;
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
        }

        /* صورة القارئ المحسنة */
        .reciter-image-container {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .reciter-image-wrapper {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
            border-radius: 50%;
            padding: 8px;
            background: linear-gradient(135deg, #10b981, #34d399, #6ee7b7);
            animation: float 3s ease-in-out infinite, rotateBorder 10s linear infinite;
            box-shadow: 0 20px 60px rgba(16, 185, 129, 0.4);
        }

        @keyframes rotateBorder {
            0% { transform: rotate(0deg) translateY(0); }
            50% { transform: rotate(180deg) translateY(-10px); }
            100% { transform: rotate(360deg) translateY(0); }
        }

        .reciter-image {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 6px solid rgba(6, 78, 59, 0.9);
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.3);
        }

        .default-icon {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(52, 211, 153, 0.3));
            border: 6px solid rgba(6, 78, 59, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 130px;
            color: rgba(209, 250, 229, 0.6);
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.3);
        }

        .reciter-name-display {
            margin-top: 20px;
            font-size: 22px;
            font-weight: 700;
            color: #d1fae5;
            text-align: center;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .track-title-player {
            font-size: 28px;
            font-weight: 800;
            color: #fef3c7;
            text-align: center;
            margin-bottom: 40px;
            text-shadow: 0 2px 15px rgba(0, 0, 0, 0.3);
            line-height: 1.4;
            padding: 20px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(52, 211, 153, 0.15));
            border-radius: 20px;
            border: 2px solid rgba(209, 250, 229, 0.3);
        }

        /* شريط التقدم المحسن */
        .progress-section {
            margin-bottom: 35px;
            background: rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 20px;
            border: 2px solid rgba(209, 250, 229, 0.2);
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 16px;
            color: #d1fae5;
            font-weight: 700;
        }

        .progress-bar-container {
            width: 100%;
            height: 14px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .progress-bar-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmerProgress 2s linear infinite;
        }

        @keyframes shimmerProgress {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399, #6ee7b7);
            border-radius: 10px;
            width: 0;
            transition: width 0.1s ease;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.8);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 100%;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 10px;
            filter: blur(5px);
        }

        /* أزرار التحكم المحسنة */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            margin-bottom: 40px;
        }

        .control-btn {
            width: 65px;
            height: 65px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            border: 3px solid rgba(209, 250, 229, 0.4);
            color: #d1fae5;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 26px;
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.3);
        }

        .control-btn:hover {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(52, 211, 153, 0.4));
            border-color: #d1fae5;
            transform: scale(1.15);
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.6);
        }

        .control-btn:active {
            transform: scale(1.05);
        }

        .play-pause-btn {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #10b981, #34d399);
            border: 4px solid #d1fae5;
            font-size: 38px;
            box-shadow: 0 10px 40px rgba(16, 185, 129, 0.6);
        }

        .play-pause-btn:hover {
            background: linear-gradient(135deg, #059669, #10b981);
            transform: scale(1.2);
            box-shadow: 0 15px 50px rgba(16, 185, 129, 0.8);
        }

        /* التحكم في الصوت المحسن */
        .volume-control {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(52, 211, 153, 0.1));
            border: 2px solid rgba(209, 250, 229, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .volume-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            color: #d1fae5;
            font-weight: 700;
            font-size: 18px;
        }

        .volume-slider {
            width: 100%;
            height: 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #34d399);
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.6);
            transition: all 0.3s ease;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            transform: scale(1.3);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.8);
        }

        .volume-slider::-moz-range-thumb {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #34d399);
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.6);
        }

        /* خيارات إضافية */
        .player-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .option-btn {
            flex: 1;
            min-width: 150px;
            padding: 18px 22px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            border: 2px solid rgba(209, 250, 229, 0.3);
            border-radius: 18px;
            color: #d1fae5;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 17px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.2);
        }

        .option-btn:hover {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(52, 211, 153, 0.4));
            border-color: #d1fae5;
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }

        .option-btn i {
            font-size: 22px;
        }

        /* مودال المعلومات */
        .info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(135deg, #064e3b, #065f46);
            border: 2px solid rgba(209, 250, 229, 0.3);
            border-radius: 25px;
            padding: 35px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(209, 250, 229, 0.2);
        }

        .modal-header h3 {
            font-size: 26px;
            color: #fef3c7;
            font-weight: 800;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid rgba(254, 202, 202, 0.3);
            color: #fecaca;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 20px;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.4);
            transform: rotate(90deg);
        }

        .modal-body {
            color: #d1fae5;
            line-height: 1.8;
            font-size: 16px;
        }

        .modal-body h4 {
            color: #fef3c7;
            margin: 20px 0 10px;
            font-size: 19px;
            font-weight: 700;
        }

        .modal-body ul {
            list-style: none;
            padding-right: 0;
        }

        .modal-body li {
            padding: 8px 0;
            padding-right: 25px;
            position: relative;
        }

        .modal-body li::before {
            content: '✓';
            position: absolute;
            right: 0;
            color: #10b981;
            font-weight: bold;
        }

        /* استجابة للشاشات الصغيرة */
        @media (max-width: 768px) {
            .bismillah {
                font-size: 38px;
            }

            .hero h1 {
                font-size: 28px;
            }

            .search-box {
                flex-direction: column;
            }

            .search-btn {
                width: 100%;
                justify-content: center;
            }

            .track-item {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .track-actions {
                width: 100%;
                justify-content: center;
            }

            .developer-footer {
                flex-direction: column;
                gap: 10px;
                padding: 15px;
            }

            .reciter-image-wrapper {
                width: 240px;
                height: 240px;
            }

            .default-icon {
                font-size: 100px;
            }

            .track-title-player {
                font-size: 22px;
            }

            .controls {
                gap: 15px;
            }

            .control-btn {
                width: 55px;
                height: 55px;
                font-size: 22px;
            }

            .play-pause-btn {
                width: 75px;
                height: 75px;
                font-size: 32px;
            }

            .player-options {
                flex-direction: column;
            }

            .option-btn {
                min-width: auto;
            }
        }

        /* تنسيقات إضافية */
        .hidden {
            display: none !important;
        }

        ::selection {
            background: rgba(16, 185, 129, 0.3);
            color: white;
        }

        /* سكرول مخصص */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #10b981, #34d399);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #059669, #10b981);
        }
    </style>
</head>
<body>
    <!-- الصفحة الرئيسية -->
    <div id="mainPage" class="container">
        <!-- البسملة -->
        <div class="bismillah-container">
            <h1 class="bismillah">﷽</h1>
            <div class="bismillah-ornament">
                <div class="ornament-line"></div>
                <span>✦</span>
                <div class="ornament-line"></div>
            </div>
        </div>

        <!-- الهيدر -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-quran"></i>
                <span>تلاوات القرآن الكريم</span>
            </div>
            <div class="header-icons">
                <button class="icon-btn" onclick="showInfo()" title="معلومات">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </div>

        <!-- البانر الترحيبي -->
        <div class="welcome-banner">
            <h2>
                <i class="fas fa-star-and-crescent"></i>
                مرحباً بك في تلاوات القرآن الكريم
            </h2>
            <p>استمع إلى أجمل التلاوات من مشاهير القراء من جميع أنحاء العالم</p>
        </div>

        <!-- منطقة البحث -->
        <div class="hero">
            <h1>ابحث عن تلاوتك المفضلة</h1>
            <p>ابحث عن أي قارئ</p>

            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ابحث عن قارئ..." 
                       onkeypress="if(event.key === 'Enter') search()">
                <button class="search-btn" onclick="search()">
                    <i class="fas fa-search"></i>
                    بحث
                </button>
            </div>

            <!-- القراء المميزون -->
            <div class="reciters-section" style="margin-top: 40px;">
                <div class="section-header-reciters">
                    <div class="section-icon"><i class="fas fa-mosque"></i></div>
                    <h2 class="section-title-reciters">القراء المميزون</h2>
                    <div class="section-icon"><i class="fas fa-mosque"></i></div>
                </div>
                
                <div class="reciters-grid">
                    <!-- ماهر المعيقلي -->
                    <div class="reciter-card" onclick="searchSuggestion('ماهر المعيقلي')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">ماهر المعيقلي</h3>
                        <div class="reciter-badge">إمام الحرم المكي</div>
                    </div>

                    <!-- ياسر الدوسري -->
                    <div class="reciter-card" onclick="searchSuggestion('ياسر الدوسري')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">ياسر الدوسري</h3>
                        <div class="reciter-badge">قارئ مميز</div>
                    </div>

                    <!-- سعود الشريم -->
                    <div class="reciter-card" onclick="searchSuggestion('سعود الشريم')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">سعود الشريم</h3>
                        <div class="reciter-badge">إمام الحرم المكي</div>
                    </div>

                    <!-- ناصر القطامي -->
                    <div class="reciter-card" onclick="searchSuggestion('ناصر القطامي')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">ناصر القطامي</h3>
                        <div class="reciter-badge">قارئ مميز</div>
                    </div>

                    <!-- خالد الجليل -->
                    <div class="reciter-card" onclick="searchSuggestion('خالد الجليل')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">خالد الجليل</h3>
                        <div class="reciter-badge">قارئ مميز</div>
                    </div>

                    <!-- فارس عباد -->
                    <div class="reciter-card" onclick="searchSuggestion('فارس عباد')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">فارس عباد</h3>
                        <div class="reciter-badge">قارئ مميز</div>
                    </div>

                    <!-- إسلام صبحي -->
                    <div class="reciter-card" onclick="searchSuggestion('إسلام صبحي')">
                        <div class="reciter-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="reciter-name">إسلام صبحي</h3>
                        <div class="reciter-badge">قارئ مميز</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- منطقة النتائج -->
        <div class="results-container">
            <div class="loading-indicator" id="loadingIndicator">
                <div class="spinner"></div>
                <div class="loading-text">جاري البحث...</div>
            </div>
            <div id="resultsArea"></div>
        </div>
    </div>

    <!-- Footer المطور -->
    <div class="developer-footer">
        <div class="developer-info">
            <i class="fas fa-code"></i>
            <span>تطوير: <span class="developer-name">قصري ناجي</span></span>
        </div>
        <a href="https://t.me/ffdks" target="_blank" class="telegram-link">
            <i class="fab fa-telegram"></i>
            <span>تواصل معي</span>
        </a>
    </div>

    <!-- صفحة المشغل -->
    <div class="player-page" id="playerPage">
        <div class="player-header">
            <h2 class="logo">
                <i class="fas fa-quran"></i>
                المشغل
            </h2>
            <button class="close-player-btn" onclick="closePlayer()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="player-loading" id="playerLoading">
            <div class="loading-spinner"></div>
            <div class="loading-text">جاري تحميل التلاوة...</div>
        </div>

        <div class="player-content" id="playerContent">
            <!-- صورة القارئ -->
            <div class="reciter-image-container">
                <div class="reciter-image-wrapper" id="reciterImageContainer">
                    <div class="default-icon">
                        <i class="fas fa-quran"></i>
                    </div>
                </div>
                <div class="reciter-name-display" id="reciterNameDisplay"></div>
            </div>

            <!-- عنوان التلاوة -->
            <div class="track-title-player" id="trackTitlePlayer">اسم التلاوة</div>

            <!-- شريط التقدم -->
            <div class="progress-section">
                <div class="time-display">
                    <span id="currentTime">0:00</span>
                    <span id="duration">0:00</span>
                </div>
                <div class="progress-bar-container" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <!-- أزرار التحكم -->
            <div class="controls">
                <button class="control-btn" onclick="seekBackward()" title="رجوع 10 ثواني">
                    <i class="fas fa-backward"></i>
                </button>
                <button class="control-btn play-pause-btn" id="playPauseBtn" onclick="togglePlayPause()">
                    <i class="fas fa-play"></i>
                </button>
                <button class="control-btn" onclick="seekForward()" title="تقديم 10 ثواني">
                    <i class="fas fa-forward"></i>
                </button>
            </div>

            <!-- التحكم في الصوت -->
            <div class="volume-control">
                <div class="volume-label">
                    <span><i class="fas fa-volume-up"></i> مستوى الصوت</span>
                    <span id="volumeValue">80%</span>
                </div>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="80">
            </div>

            <!-- خيارات إضافية -->
            <div class="player-options">
                <button class="option-btn" id="loopBtn" onclick="toggleLoop()">
                    <i class="fas fa-redo"></i>
                    <span id="loopText">تكرار</span>
                </button>
                <button class="option-btn" onclick="downloadCurrentTrack()">
                    <i class="fas fa-download"></i>
                    <span>تحميل</span>
                </button>
            </div>
        </div>

        <audio id="audioPlayer"></audio>
    </div>

    <!-- مودال المعلومات -->
    <div class="info-modal" id="infoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> حول التطبيق</h3>
                <button class="modal-close" onclick="closeInfo()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p><strong>تلاوات القرآن الكريم</strong> - منصة لتشغيل وتحميل التلاوات القرآنية</p>
                
                <h4>المميزات:</h4>
                <ul>
                    <li>البحث عن جميع القراء</li>
                    <li>تشغيل مباشر للتلاوات</li>
                    <li>تحميل التلاوات بجودة عالية</li>
                    <li>واجهة سهلة الاستخدام</li>
                    <li>دعم كامل للغة العربية</li>
                </ul>

                <h4>اختصارات لوحة المفاتيح:</h4>
                <ul>
                    <li>مسافة: تشغيل/إيقاف</li>
                    <li>← : تقديم 10 ثواني</li>
                    <li>→ : رجوع 10 ثواني</li>
                </ul>

                <h4>المطور:</h4>
                <p style="color: #10b981; font-weight: 700;">قصري ناجي</p>
                <p style="margin-top: 10px;">للتواصل: <a href="https://t.me/ffdks" target="_blank" style="color: #34d399; text-decoration: underline;">@ffdks</a></p>

                <p style="margin-top: 25px; text-align: center; color: #10b981; font-weight: 700;">
                    جزاكم الله خيراً
                </p>
            </div>
        </div>
    </div>

    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        let currentUrl = '';
        let currentTitle = '';
        let currentReciter = '';
        let isLooping = false;
        let recitersData = null;

        // أسماء السور بالترتيب
        const surahNames = [
            'الفاتحة', 'البقرة', 'آل عمران', 'النساء', 'المائدة', 'الأنعام', 'الأعراف', 'الأنفال', 'التوبة', 'يونس',
            'هود', 'يوسف', 'الرعد', 'إبراهيم', 'الحجر', 'النحل', 'الإسراء', 'الكهف', 'مريم', 'طه',
            'الأنبياء', 'الحج', 'المؤمنون', 'النور', 'الفرقان', 'الشعراء', 'النمل', 'القصص', 'العنكبوت', 'الروم',
            'لقمان', 'السجدة', 'الأحزاب', 'سبأ', 'فاطر', 'يس', 'الصافات', 'ص', 'الزمر', 'غافر',
            'فصلت', 'الشورى', 'الزخرف', 'الدخان', 'الجاثية', 'الأحقاف', 'محمد', 'الفتح', 'الحجرات', 'ق',
            'الذاريات', 'الطور', 'النجم', 'القمر', 'الرحمن', 'الواقعة', 'الحديد', 'المجادلة', 'الحشر', 'الممتحنة',
            'الصف', 'الجمعة', 'المنافقون', 'التغابن', 'الطلاق', 'التحريم', 'الملك', 'القلم', 'الحاقة', 'المعارج',
            'نوح', 'الجن', 'المزمل', 'المدثر', 'القيامة', 'الإنسان', 'المرسلات', 'النبأ', 'النازعات', 'عبس',
            'التكوير', 'الانفطار', 'المطففين', 'الانشقاق', 'البروج', 'الطارق', 'الأعلى', 'الغاشية', 'الفجر', 'البلد',
            'الشمس', 'الليل', 'الضحى', 'الشرح', 'التين', 'العلق', 'القدر', 'البينة', 'الزلزلة', 'العاديات',
            'القارعة', 'التكاثر', 'العصر', 'الهمزة', 'الفيل', 'قريش', 'الماعون', 'الكوثر', 'الكافرون', 'النصر',
            'المسد', 'الإخلاص', 'الفلق', 'الناس'
        ];

        // جلب بيانات القراء مرة واحدة
        async function loadRecitersData() {
            if (recitersData) return recitersData;
            
            try {
                const response = await fetch('https://www.mp3quran.net/api/v3/reciters?language=ar');
                const data = await response.json();
                recitersData = data.reciters || [];
                return recitersData;
            } catch (error) {
                console.error('خطأ في جلب بيانات القراء:', error);
                return [];
            }
        }

        // تحميل البيانات عند بدء الصفحة
        window.addEventListener('DOMContentLoaded', () => {
            loadRecitersData();
        });

        // عرض جميع القراء
        async function loadAllReciters() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const resultsArea = document.getElementById('resultsArea');
            
            loadingIndicator.style.display = 'block';
            resultsArea.innerHTML = '';

            try {
                const reciters = await loadRecitersData();
                loadingIndicator.style.display = 'none';

                if (reciters.length === 0) {
                    resultsArea.innerHTML = `
                        <div style="text-align: center; padding: 50px;">
                            <i class="fas fa-exclamation-circle" style="font-size: 60px; margin-bottom: 20px; color: rgba(255,255,255,0.3);"></i>
                            <h3 style="color: #fef3c7; margin-bottom: 10px;">لا توجد بيانات</h3>
                        </div>
                    `;
                } else {
                    displayReciters(reciters);
                }
            } catch (error) {
                loadingIndicator.style.display = 'none';
                resultsArea.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #fca5a5;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 60px; margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 10px;">حدث خطأ</h3>
                        <p>الرجاء المحاولة مرة أخرى</p>
                    </div>
                `;
            }
        }

        // البحث عن القراء
        async function search() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) {
                alert('⚠️ الرجاء إدخال اسم القارئ للبحث');
                return;
            }

            const loadingIndicator = document.getElementById('loadingIndicator');
            const resultsArea = document.getElementById('resultsArea');
            
            loadingIndicator.style.display = 'block';
            resultsArea.innerHTML = '';

            try {
                const reciters = await loadRecitersData();
                loadingIndicator.style.display = 'none';

                const filtered = reciters.filter(reciter => 
                    reciter.name && reciter.name.includes(query)
                );

                if (filtered.length === 0) {
                    resultsArea.innerHTML = `
                        <div style="text-align: center; padding: 50px;">
                            <i class="fas fa-search" style="font-size: 60px; margin-bottom: 20px; color: rgba(255,255,255,0.3);"></i>
                            <h3 style="color: #fef3c7; margin-bottom: 10px;">لم يتم العثور على قراء</h3>
                            <p style="color: #d1fae5;">حاول البحث باسم آخر</p>
                        </div>
                    `;
                } else {
                    displayReciters(filtered);
                }
            } catch (error) {
                loadingIndicator.style.display = 'none';
                resultsArea.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #fca5a5;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 60px; margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 10px;">حدث خطأ في البحث</h3>
                        <p>الرجاء المحاولة مرة أخرى</p>
                    </div>
                `;
            }
        }

        // عرض القراء
        function displayReciters(reciters) {
            const area = document.getElementById('resultsArea');
            
            let html = `
                <div class="results-header">
                    <i class="fas fa-users"></i>
                    القراء (${reciters.length})
                </div>
            `;
            
            html += reciters.map(reciter => {
                const hasMoshaf = reciter.moshaf && reciter.moshaf.length > 0;
                
                return `
                    <div class="track-item" ${hasMoshaf ? `style="cursor: pointer;" onclick="showSuwar('${encodeURIComponent(JSON.stringify(reciter))}')"` : ''}>
                        <div class="track-info">
                            <h4>
                                <i class="fas fa-user"></i>
                                ${reciter.name || 'قارئ'}
                            </h4>
                            <div class="duration">
                                <i class="fas fa-book-quran"></i>
                                ${hasMoshaf ? reciter.moshaf.length + ' مصحف' : 'لا توجد تلاوات'}
                            </div>
                        </div>
                        <div class="track-actions">
                            ${hasMoshaf ? `
                                <button class="circle-btn" onclick="event.stopPropagation(); showSuwar('${encodeURIComponent(JSON.stringify(reciter))}')">
                                    <i class="fas fa-list"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            area.innerHTML = html;
        }

        // عرض السور مرتبة
        function showSuwar(reciterJson) {
            const reciter = JSON.parse(decodeURIComponent(reciterJson));
            const area = document.getElementById('resultsArea');
            
            if (!reciter.moshaf || reciter.moshaf.length === 0) {
                alert('⚠️ لا توجد تلاوات لهذا القارئ');
                return;
            }

            const moshaf = reciter.moshaf[0];
            const server = moshaf.server;
            const surahList = moshaf.surah_list ? moshaf.surah_list.split(',').map(n => parseInt(n)) : [];

            if (surahList.length === 0) {
                alert('⚠️ لا توجد سور متاحة');
                return;
            }

            // ترتيب السور حسب رقمها
            surahList.sort((a, b) => a - b);

            let html = `
                <div style="margin-bottom: 20px;">
                    <button class="search-btn" onclick="search()" style="margin: 0;">
                        <i class="fas fa-arrow-right"></i>
                        رجوع
                    </button>
                </div>
                <div class="results-header">
                    <i class="fas fa-book-quran"></i>
                    ${reciter.name} - السور المتاحة (${surahList.length})
                </div>
            `;
            
            html += surahList.map(num => {
                const paddedNum = num.toString().padStart(3, '0');
                const surahName = surahNames[num - 1] || `سورة ${num}`;
                const audioUrl = `${server}${paddedNum}.mp3`;
                
                return `
                    <div class="track-item">
                        <div class="track-info">
                            <h4>
                                <i class="fas fa-music"></i>
                                ${num}. سورة ${surahName}
                            </h4>
                            <div class="duration">
                                <i class="fas fa-user"></i>
                                ${reciter.name}
                            </div>
                        </div>
                        <div class="track-actions">
                            <button class="circle-btn" onclick="openPlayer('${encodeURIComponent(audioUrl)}', 'سورة ${surahName}', '${encodeURIComponent(reciter.name)}')">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="circle-btn download-btn" onclick="downloadAudio('${encodeURIComponent(audioUrl)}', 'سورة ${surahName} - ${reciter.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            area.innerHTML = html;
        }

        // اقتراح بحث
        function searchSuggestion(query) {
            document.getElementById('searchInput').value = query;
            search();
        }

        // صور القراء
        const reciterImages = {
            'عبد الباسط': 'https://i.pinimg.com/736x/5e/86/0a/5e860a89c8c4f3c8b8c4f3c8b8c4f3c8.jpg',
            'المنشاوي': 'https://i.pinimg.com/736x/a1/b2/c3/a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6.jpg',
            'السديس': 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Abdulrahman_Al-Sudais.jpg/440px-Abdulrahman_Al-Sudais.jpg',
            'المعيقلي': 'https://i.pinimg.com/736x/7a/8b/9c/7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d.jpg',
            'الحصري': 'https://i.pinimg.com/736x/9a/0b/1c/9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d.jpg',
        };

        // عرض صورة القارئ
        function displayReciterImage(reciterName) {
            const container = document.getElementById('reciterImageContainer');
            const nameDisplay = document.getElementById('reciterNameDisplay');
            let imageFound = false;
            
            nameDisplay.textContent = reciterName || '';
            
            for (const [name, url] of Object.entries(reciterImages)) {
                if (reciterName && reciterName.includes(name)) {
                    container.innerHTML = `<img src="${url}" alt="${name}" class="reciter-image" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'default-icon\\'><i class=\\'fas fa-quran\\'></i></div>'">`;
                    imageFound = true;
                    break;
                }
            }
            
            if (!imageFound) {
                container.innerHTML = '<div class="default-icon"><i class="fas fa-quran"></i></div>';
            }
        }

        // فتح المشغل
        function openPlayer(url, title, reciter) {
            const decodedUrl = decodeURIComponent(url);
            const decodedTitle = decodeURIComponent(title);
            const decodedReciter = reciter ? decodeURIComponent(reciter) : '';
            
            if (!decodedUrl || decodedUrl === 'undefined') {
                alert('⚠️ لا يوجد رابط صوتي لهذه التلاوة');
                return;
            }

            currentUrl = decodedUrl;
            currentTitle = decodedTitle;
            currentReciter = decodedReciter;
            
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('playerPage').classList.add('active');
            document.getElementById('playerLoading').style.display = 'flex';
            document.getElementById('playerContent').style.display = 'none';
            document.getElementById('trackTitlePlayer').textContent = currentTitle;

            displayReciterImage(currentReciter);

            audioPlayer.src = currentUrl;
            audioPlayer.volume = 0.8;

            audioPlayer.addEventListener('canplay', function onCanPlay() {
                document.getElementById('playerLoading').style.display = 'none';
                document.getElementById('playerContent').style.display = 'flex';
                audioPlayer.play();
                updatePlayPauseIcon();
                audioPlayer.removeEventListener('canplay', onCanPlay);
            }, { once: true });

            audioPlayer.addEventListener('error', function onError() {
                alert('❌ حدث خطأ في تحميل التلاوة');
                closePlayer();
                audioPlayer.removeEventListener('error', onError);
            }, { once: true });
        }

        // إغلاق المشغل
        function closePlayer() {
            audioPlayer.pause();
            audioPlayer.src = '';
            document.getElementById('playerPage').classList.remove('active');
            document.getElementById('mainPage').style.display = 'block';
            document.body.classList.remove('playing');
        }

        // تشغيل/إيقاف
        function togglePlayPause() {
            if (!audioPlayer.src) return;
            
            if (audioPlayer.paused) {
                audioPlayer.play();
                document.body.classList.add('playing');
            } else {
                audioPlayer.pause();
                document.body.classList.remove('playing');
            }
            updatePlayPauseIcon();
        }

        function updatePlayPauseIcon() {
            const icon = document.getElementById('playPauseBtn').querySelector('i');
            if (audioPlayer.paused) {
                icon.className = 'fas fa-play';
            } else {
                icon.className = 'fas fa-pause';
            }
        }

        // تحديث شريط التقدم
        audioPlayer.addEventListener('timeupdate', () => {
            if (audioPlayer.duration && !isNaN(audioPlayer.duration)) {
                const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('currentTime').textContent = formatTime(audioPlayer.currentTime);
            }
        });

        audioPlayer.addEventListener('loadedmetadata', () => {
            if (audioPlayer.duration && !isNaN(audioPlayer.duration)) {
                document.getElementById('duration').textContent = formatTime(audioPlayer.duration);
            }
        });

        document.getElementById('progressBar').addEventListener('click', (e) => {
            if (!audioPlayer.duration || isNaN(audioPlayer.duration)) return;
            
            const rect = e.currentTarget.getBoundingClientRect();
            const pos = (e.clientX - rect.left) / rect.width;
            audioPlayer.currentTime = pos * audioPlayer.duration;
        });

        // التحكم في الصوت
        document.getElementById('volumeSlider').addEventListener('input', (e) => {
            audioPlayer.volume = e.target.value / 100;
            document.getElementById('volumeValue').textContent = e.target.value + '%';
        });

        function seekForward() {
            if (!audioPlayer.duration || isNaN(audioPlayer.duration)) return;
            audioPlayer.currentTime = Math.min(audioPlayer.currentTime + 10, audioPlayer.duration);
        }

        function seekBackward() {
            audioPlayer.currentTime = Math.max(audioPlayer.currentTime - 10, 0);
        }

        function toggleLoop() {
            isLooping = !isLooping;
            audioPlayer.loop = isLooping;
            const btn = document.getElementById('loopBtn');
            if (isLooping) {
                btn.style.background = 'linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(52, 211, 153, 0.4))';
                btn.style.borderColor = '#d1fae5';
                document.getElementById('loopText').textContent = 'إيقاف التكرار';
            } else {
                btn.style.background = 'linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2))';
                btn.style.borderColor = 'rgba(209, 250, 229, 0.3)';
                document.getElementById('loopText').textContent = 'تكرار';
            }
        }

        // تحميل الصوت
        function downloadAudio(url, title) {
            const decodedUrl = decodeURIComponent(url);
            const decodedTitle = decodeURIComponent(title);
            
            if (!decodedUrl || decodedUrl === 'undefined') {
                alert('⚠️ لا يوجد رابط للتحميل');
                return;
            }
            
            const a = document.createElement('a');
            a.href = decodedUrl;
            a.download = decodedTitle + '.mp3';
            a.target = '_blank';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert('✅ جاري التحميل...');
        }

        function downloadCurrentTrack() {
            if (!currentUrl) {
                alert('⚠️ لا يوجد تلاوة للتحميل');
                return;
            }
            downloadAudio(encodeURIComponent(currentUrl), encodeURIComponent(currentTitle + ' - ' + currentReciter));
        }

        function formatTime(seconds) {
            if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function showInfo() {
            document.getElementById('infoModal').style.display = 'flex';
        }

        function closeInfo() {
            document.getElementById('infoModal').style.display = 'none';
        }

        document.getElementById('infoModal').addEventListener('click', function(e) {
            if (e.target === this) closeInfo();
        });

        // اختصارات لوحة المفاتيح
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('playerPage').classList.contains('active')) {
                if (e.code === 'Space') {
                    e.preventDefault();
                    togglePlayPause();
                } else if (e.code === 'ArrowRight') {
                    seekForward();
                } else if (e.code === 'ArrowLeft') {
                    seekBackward();
                }
            }
        });
    </script>
</body>
</html>
